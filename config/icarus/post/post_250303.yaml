# Post-processing configuration for ICARUS
# Revision date: January 15, 2025

__meta__:
  version: "250303"
  date: "2025-03-03"
  description: "ICARUS post-processing for calibrated models"
  compatible_with:
    base: ">=240719"
    io: ">=240719"
    model: ">=250303"
  tags: [normalized-fm]

include: post_common.yaml

override:
  # Flash matching configuration
  post.flash_match:
    cfg: flashmatch/flashmatch_250214.cfg
    flash_key: flashes
    volume: module
    ref_volume_id: 0
    method: likelihood

  # Containment configuration
  post.containment:
    run_mode: both
    mode: source
    margin: 5.0
    cathode_margin: -5.0
    min_particle_sizes:
      0: 25
      1: 25
    priority: 1

  # Custom primary score thresholding
  post.particle_threshold:
    primary_threshold: 0.1
    priority: 4

  # Radius restriction in direction estimate
  post.direction.radius: 60.0 # cm

  # Shower fudge factor
  post.calo_ke.shower_fudge: 1.2359

  # No threshold on maximum michel KE
  post.shape_logic-: maximum_michel_ke

  # Visibility thresholds
  post.topology_threshold-: truth_ke_mode
  post.topology_threshold.ke_thresholds:
    4: 50
    default: 25

  # No orientation updates after vertexing
  post.vertex-: update_orientations
