# Configuration for ICARUS with collection-only (January 2025 weights - restrict_v2)
include: icarus_base.cfg

override:
  # Weight path
  model.weight_path: /sdf/data/neutrino/icarus/spine/train/mpvmpr_v03/weights/full_chain/restrict_v2/snapshot-2999.ckpt

  # No calibration applied in the chain, handled in post-processing
  model.modules.chain.calibration: null
  model.modules.calibration: null
  model.network_input-: meta

  post.apply_calibrations:
    gain:
      gain: 84.2408
    recombination:
      efield: 0.4938 # kV/cm
      model: mbox
    lifetime:
      lifetime: 3000
      driftv: 0.157565
    priority: 7

  # Loss adjustments
  model.modules.grappa_shower_loss.node_loss.use_closest: null

  # Post-processors related to showers not used in this config
  post-:
    - start_dedx
    - end_dedx
    - time_containment
    - particle_spread
    - shower_conversion_distance
    - shower_start_correction
    - shower_start_merge
    - start_straightness
  
  # Older post-processor settings
  post.flash_match.legacy: true
  post.flash_match.scaling: 1/350
  post.flash_match.cfg: flashmatch_230930.cfg

  post.containment-:
    - truth_point_mode
    - exclude_pids
  post.containment.min_particle_sizes:
    0: 25
    1: 25

  post.calo_ke.shower_fudge: 1/0.83
  
  post.shape_logic-: maximum_michel_ke

  post.topology_threshold-: truth_ke_mode
  post.topology_threshold.ke_thresholds:
    4: 50
    default: 25

  post.vertex-: update_orientations

